{"version":3,"file":"index.modern.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { ReactNode, createContext, useContext, useRef } from 'react'\n\nimport { createStore, useStore as useStoreZustand } from 'zustand'\nimport { StateCreator, StoreMutatorIdentifier } from 'zustand/vanilla'\n\nexport const createProvider =\n  <T, >() =>\n    <Mos extends [StoreMutatorIdentifier, unknown][] = []>(initializer: StateCreator<T, [], Mos>) => {\n\n      type TInitialState = Partial<T>\n      type TInitState = (prevStore: ReturnType<typeof initializer>) => TInitialState;\n      const initializeStore = (initialState: TInitState | TInitialState) =>\n        createStore<T>()((...args) => {\n          const initStore = initializer(...args)\n          let initState: TInitialState = {}\n          if (typeof initialState === 'function') {\n            initState = initialState(initStore)\n          } else {\n            initState = initialState\n          }\n          return {\n            ...initStore,\n            ...initState\n          }\n        })\n\n      type StoreType = ReturnType<typeof initializeStore>;\n\n      const ZustandContext = createContext<StoreType | null>(null)\n\n      const StoreProvider = ({\n                               children,\n                               initialState\n                             }: {\n        children: ReactNode;\n        initialState: TInitState | TInitialState;\n      }) => {\n        const storeRef = useRef<StoreType>()\n        if (!storeRef.current) {\n          storeRef.current = initializeStore(initialState)\n        }\n        return <ZustandContext.Provider value={storeRef.current}>{children}</ZustandContext.Provider>\n      }\n\n      const useStore = <R, >(selector: (state: T) => R, shallow?: (a: R, b: R) => boolean): R => {\n        const store = useContext(ZustandContext)\n\n        if (!store) throw new Error('Store is missing the provider')\n\n        return useStoreZustand(store, selector, shallow)\n      }\n\n      return { Provider: StoreProvider, useStore }\n    }\n"],"names":["createProvider","initializer","initializeStore","initialState","createStore","initStore","apply","arguments","initState","_extends","ZustandContext","createContext","StoreProvider","_ref","children","storeRef","useRef","current","React","Provider","value","useStore","selector","shallow","store","useContext","Error","useStoreZustand"],"mappings":";;;;;;;;;;;;;;;;;;IAKaA,cAAc,GACzB,SADWA,cAAcA;EAAA,OAEvB,UAAuDC,WAAqC;IAI1F,IAAMC,eAAe,GAAG,SAAlBA,eAAeA,CAAIC,YAAwC;MAAA,OAC/DC,WAAW,EAAK,CAAC;QACf,IAAMC,SAAS,GAAGJ,WAAW,CAAAK,KAAA,SAAAC,SAAQ,CAAC;QACtC,IAAIC,SAAS,GAAkB,EAAE;QACjC,IAAI,OAAOL,YAAY,KAAK,UAAU,EAAE;UACtCK,SAAS,GAAGL,YAAY,CAACE,SAAS,CAAC;SACpC,MAAM;UACLG,SAAS,GAAGL,YAAY;;QAE1B,OAAAM,QAAA,KACKJ,SAAS,EACTG,SAAS;OAEf,CAAC;;IAIJ,IAAME,cAAc,GAAGC,aAAa,CAAmB,IAAI,CAAC;IAE5D,IAAMC,aAAa,GAAG,SAAhBA,aAAaA,CAAAC,IAAA;UACMC,QAAQ,GAAAD,IAAA,CAARC,QAAQ;QACRX,YAAY,GAAAU,IAAA,CAAZV,YAAY;MAKnC,IAAMY,QAAQ,GAAGC,MAAM,EAAa;MACpC,IAAI,CAACD,QAAQ,CAACE,OAAO,EAAE;QACrBF,QAAQ,CAACE,OAAO,GAAGf,eAAe,CAACC,YAAY,CAAC;;MAElD,OAAOe,oBAACR,cAAc,CAACS,QAAQ;QAACC,KAAK,EAAEL,QAAQ,CAACE;SAAUH,QAAQ,CAA2B;KAC9F;IAED,IAAMO,UAAQ,GAAG,SAAXA,UAAQA,CAASC,QAAyB,EAAEC,OAAiC;MACjF,IAAMC,KAAK,GAAGC,UAAU,CAACf,cAAc,CAAC;MAExC,IAAI,CAACc,KAAK,EAAE,MAAM,IAAIE,KAAK,CAAC,+BAA+B,CAAC;MAE5D,OAAOC,QAAe,CAACH,KAAK,EAAEF,QAAQ,EAAEC,OAAO,CAAC;KACjD;IAED,OAAO;MAAEJ,QAAQ,EAAEP,aAAa;MAAES,QAAQ,EAARA;KAAU;GAC7C;AAAA;;;;"}